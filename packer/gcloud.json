{
  "variables": {
    "upgrade": "0",
    "ansible_groups" : "{{ env `ANSIBLE_GROUPS` }}"
  },
  "builders": [
    {
      "type":           "null",
      "communicator":   "ssh",
      "ssh_pty":        true,
      "ssh_host":       "carapace.gcloud",
      "ssh_port":       "22",
      "ssh_username":   "darkilliant",
      "ssh_private_key_file": "/home/darkilliant/.ssh/google_compute_engine",
      "ssh_timeout": "2s"
    }
  ],
  "provisioners" : [
    {
      "type": "shell-local",
      "command": "find ansible/vendor/roles/ -type l | xargs -I % -n 1 unlink %"
    },
    {
      "type": "ansible",
      "playbook_file": "./ansible/playbook.yml",
      "groups" : ["{{ user `ansible_groups` }}"],
      "user" : "darkilliant",
      "extra_arguments" : [
        "--extra-vars", "symfony_env=prod"
      ]
    }
  ]
}
